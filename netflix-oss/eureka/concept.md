# Eureka
- 클라우드 상에서의 서비스를 찾기위해 사용되는 REST기반의 서비스.
- 미들 티어에서 페일오버와 로드 밸런싱이 목적이다.

#### 왜 필요한가?
- 클라우드에서는 서버들이 동적으로 유지된다.
- 전통적인 로드 밸런서와 달리 알려진 호스트 이름, IP로 등록, 해제하는 것이 아님.
- Eureka는 미들 티어에서 이 차이를 매꿔줌.

#### AWS ELB와의 차이점
- ELB는 엔드 유저 트래픽에 노출 되는 서비스 이다.
- Eureka를 ELB 뒤에 위치 시켜 외부에 노출 시킬 수는 있지만 AWS Securigy Group의 장점을 잃어버림.
- ELB는 프록시 기반, Eureka는 인스턴스/서버/호스트 레벨에서 로드 밸런싱을 한다.
- Eureka는 클라이언트에서 서버들의 정보를 알 고 있음.
- 그렇기 때문에 LB 장애에도 견딜 수 있음.

#### Reoute 53과의 차이점
- Route 53은 AWS 외부의 DNS 레코드를 호스팅 할 수 있다.
- Eureka는 내부 DNS처럼 동작하며 다른 AWS 리전의 서버들에 대해서는 알 수 없다.

#### 넷플릭스에서는 어떻게 사용하는가?
- Netflix Asgard를 사용한 red/black 배포.
  - Netflix Asgard - AWS 클라우드에서의 어플리케이션 배포, 관리를 도와주는 웹 기반 툴. Deprecated되었고 [Spinnaker](www.spinnaker.io)로 대체되었다.
- cassandra의 배포에서 인스턴스 제외함.
- memcached 캐싱 서비스에서 노드 목록 식별함.
- 다양한 어플리케이션 메타데이터를 전달함.

#### 언제 Eureka를 사용해야 하나?
- 외부에게 트래픽을 노출하지 않고 간단한 라운드 로빈 LB 솔루션을 필요로 할 때.
- sticky 세션이 필요하지 않으며 외부의 세션 데이터를 로드할 필요가 없을 때.
- 아키텍쳐가 클라이언트 기반 로드 밸런서 모델에 적합할 때.

#### 아키텍쳐
![](https://github.com/Netflix/eureka/raw/master/images/eureka_architecture.png)
- 서버와 클라이언트로 나누어져 있음.
- 위의 예에서는 zone에 대한 장애 처리를 위해 zone 마다 1개씩 두고 클러스터를 구성하여 리전에 구성하였다.
- 서비스 클라이언트에서는 30초 간격으로 하트비트를 보내 서버에 등록한다.
- 몇 회 이상 서버와의 통신에 실패한는 경우 90초 후에 서버에서 제거 된다.
- 서비스의 등록 정보들은 모든 Eureka 노드에 복제된다.
